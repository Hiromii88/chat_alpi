<h1 class="text-3xl font-bold text-center mb-4">プロフィール編集</h1>

<div class="container mx-auto px-4 py-6">
  <div class="max-w-sm mx-auto bg-white p-6 rounded-lg shadow-md">
    <% if flash[:notice] %>
      <div class="bg-green-500 text-white p-3 rounded mb-4">
        <%= flash[:notice] %>
      </div>
    <% elsif flash[:alert] %>
      <div class="bg-red-500 text-white p-3 rounded mb-4">
        <%= flash[:alert] %>
      </div>
    <% end %>

    <%= form_with model: @user, url: user_path(@user), method: :patch, local: true, multipart: true do |f| %>

      <!-- ここからアイコンアップロード欄 -->
      <div class="mb-4">
        <%= f.label :icon, "アイコン画像アップロード", class: "block text-sm font-semibold mb-1" %>
        <%= f.file_field :icon, class: "w-full" %>

        <% if @user.icon.attached? %>
          <div class="mt-2">
            <p class="text-sm text-gray-600 mb-1">現在のアイコン画像：</p>
            <%= image_tag url_for(@user.icon), class: "w-24 h-24 rounded-full object-cover shadow" %>
          </div>
        <% end %>
      </div>
      <!-- ここまで -->

      <div class="mb-4">
        <%= f.label :name, "名前", class: "block text-sm font-semibold mb-1" %>
        <%= f.text_field :name, class: "w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500", placeholder: "名前を入力" %>
      </div>

      <div class="mb-4">
        <%= f.label :email, "メールアドレス", class: "block text-sm font-semibold mb-1" %>
        <%= f.email_field :email, class: "w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500", placeholder: "メールアドレスを入力" %>
      </div>

      <div class="mb-4">
        <%= f.label :password, "新しいパスワード（空欄で変更なし）", class: "block text-sm font-semibold mb-1" %>
        <%= f.password_field :password, class: "w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500", placeholder: "新しいパスワード" %>
      </div>

      <div class="mb-4">
        <%= f.label :password_confirmation, "パスワード確認", class: "block text-sm font-semibold mb-1" %>
        <%= f.password_field :password_confirmation, class: "w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500", placeholder: "もう一度入力" %>
      </div>

      <!-- 背景画像アップロード欄 -->
      <div class="mb-4">
        <%= f.label :cover_image, "背景画像アップロード", class: "block text-sm font-semibold mb-1" %>
        <%= f.file_field :cover_image, class: "w-full" %>

        <% if @user.cover_image.attached? %>
          <div class="mt-2">
            <p class="text-sm text-gray-600 mb-1">現在の背景画像：</p>
            <%= image_tag url_for(@user.cover_image), class: "w-full rounded-md shadow" %>
          </div>
        <% end %>
      </div>

      <div class="mb-4">
        <%= f.submit "更新する", class: "w-full py-2 px-4 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500" %>
      </div>
    <% end %>
  </div>
</div>
